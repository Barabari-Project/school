import{s as te,A as oe,p as O,f as S,a as B,g as T,h as $,d as b,c as H,j as h,i as E,x as D,B as F,C as V,D as ne,z as se,o as le,E as ie,y as re,e as j,F as ae}from"../chunks/scheduler.35e2a1e6.js";import{S as ce,i as ue,f as q,b as G,d as K,m as Q,a as v,t as A,c as Z,e as x,g as ee}from"../chunks/index.c2a6e5b5.js";import{e as J}from"../chunks/each.e59479a4.js";import{T as fe,h as de,C as me,a as N,b as pe,t as ge}from"../chunks/toasts.45318c18.js";const _e=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global,he="https://bbs.barabariproject.org",be={none:n=>he+"/p1/?url="+n},ve=n=>(localStorage.setItem("bbi-code",JSON.stringify({code:n,date:Date.now()/1e3})),n),we=()=>{const n=localStorage.getItem("bbi-code");if(n){const{code:e,date:i}=JSON.parse(n);let t=Date.now()/1e3-+i;if(t=t/3600,t<2)return console.log("Mounted with saved:",e),e;localStorage.removeItem("bbi-code")}return console.log("Mounted with default"),fe};const{window:P}=_e;function R(n,e,i){const t=n.slice();return t[18]=e[i],t}function U(n){let e,i='<button id="langle" class="svelte-1t18i54">&lt;</button> <button id="rangle" class="svelte-1t18i54">&gt;</button> <button id="lcurly" class="svelte-1t18i54">{</button> <button id="rcurly" class="svelte-1t18i54">}</button> <button id="copy" class="svelte-1t18i54">CopyAll</button> <button id="clear" class="svelte-1t18i54">Clear</button>',t,o;return{c(){e=S("div"),e.innerHTML=i,this.h()},l(f){e=T(f,"DIV",{class:!0,"data-svelte-h":!0}),ie(e)!=="svelte-13vffr9"&&(e.innerHTML=i),this.h()},h(){h(e,"class","p5 f buttons w-100 flow-x-s svelte-1t18i54")},m(f,l){E(f,e,l),t||(o=F(e,"click",n[6]),t=!0)},p:re,d(f){f&&b(e),t=!1,o()}}}function X(n){let e,i,t=J(n[4]),o=[];for(let l=0;l<t.length;l+=1)o[l]=Y(R(n,t,l));const f=l=>A(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=j()},l(l){for(let r=0;r<o.length;r+=1)o[r].l(l);e=j()},m(l,r){for(let s=0;s<o.length;s+=1)o[s]&&o[s].m(l,r);E(l,e,r),i=!0},p(l,r){if(r&16){t=J(l[4]);let s;for(s=0;s<t.length;s+=1){const g=R(l,t,s);o[s]?(o[s].p(g,r),v(o[s],1)):(o[s]=Y(g),o[s].c(),v(o[s],1),o[s].m(e.parentNode,e))}for(ee(),s=t.length;s<o.length;s+=1)f(s);Z()}},i(l){if(!i){for(let r=0;r<t.length;r+=1)v(o[r]);i=!0}},o(l){o=o.filter(Boolean);for(let r=0;r<o.length;r+=1)A(o[r]);i=!1},d(l){l&&b(e),ae(o,l)}}}function Y(n){let e,i;return e=new pe({props:{message:n[18].message,type:n[18].type}}),{c(){G(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,o){Q(e,t,o),i=!0},p(t,o){const f={};o&16&&(f.message=t[18].message),o&16&&(f.type=t[18].type),e.$set(f)},i(t){i||(v(e.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),i=!1},d(t){x(e,t)}}}function ye(n){let e,i,t,o,f,l,r,s,g,p,k,C,w;oe(n[8]);function L(c){n[9](c)}function z(c){n[10](c)}let M={lang:de(),styles:{"&":{fontSize:"18px",height:"100%",width:"100%"}},lineWrapping:!0};n[0]!==void 0&&(M.value=n[0]),n[2]!==void 0&&(M.view=n[2]),t=new me({props:M}),O.push(()=>q(t,"value",L)),O.push(()=>q(t,"view",z)),t.$on("change",n[5]);let d=n[3]<=768&&U(n),u=n[4].length&&X(n);return{c(){e=S("main"),i=S("div"),G(t.$$.fragment),l=B(),d&&d.c(),r=B(),s=S("iframe"),g=B(),p=S("div"),u&&u.c(),this.h()},l(c){e=T(c,"MAIN",{class:!0});var m=$(e);i=T(m,"DIV",{class:!0});var a=$(i);K(t.$$.fragment,a),a.forEach(b),l=H(m),d&&d.l(m),r=H(m),s=T(m,"IFRAME",{id:!0,frameborder:!0,title:!0,class:!0}),$(s).forEach(b),m.forEach(b),g=H(c),p=T(c,"DIV",{id:!0,class:!0});var y=$(p);u&&u.l(y),y.forEach(b),this.h()},h(){h(i,"class","editor p-rel svelte-1t18i54"),h(s,"id","mfWHAT"),h(s,"frameborder","0"),h(s,"title","Editor Output"),h(s,"class","svelte-1t18i54"),h(e,"class","f fw svelte-1t18i54"),h(p,"id","toaster"),h(p,"class","p-fix w-100 tc f-col svelte-1t18i54")},m(c,m){E(c,e,m),D(e,i),Q(t,i,null),D(e,l),d&&d.m(e,null),D(e,r),D(e,s),n[11](s),E(c,g,m),E(c,p,m),u&&u.m(p,null),k=!0,C||(w=[F(P,"click",n[7]),F(P,"resize",n[8])],C=!0)},p(c,[m]){const a={};!o&&m&1&&(o=!0,a.value=c[0],V(()=>o=!1)),!f&&m&4&&(f=!0,a.view=c[2],V(()=>f=!1)),t.$set(a),c[3]<=768?d?d.p(c,m):(d=U(c),d.c(),d.m(e,r)):d&&(d.d(1),d=null),c[4].length?u?(u.p(c,m),m&16&&v(u,1)):(u=X(c),u.c(),v(u,1),u.m(p,null)):u&&(ee(),A(u,1,1,()=>{u=null}),Z())},i(c){k||(v(t.$$.fragment,c),v(u),k=!0)},o(c){A(t.$$.fragment,c),A(u),k=!1},d(c){c&&(b(e),b(g),b(p)),x(t),d&&d.d(),n[11](null),u&&u.d(),C=!1,ne(w)}}}function ke(n,e,i){let t;se(n,ge,a=>i(4,t=a));let o="",f,l,r,s=0,g;const p=a=>{f.open(),f.write(a),f.close()},k=a=>{if(!a.includes("img"))return a;const I=new DOMParser().parseFromString(a,"text/html"),W=I.querySelectorAll("img");for(const _ of W)_.src.includes("google.com")&&(_.src=new URL(_.src).searchParams.get("url"),console.log(_.src)),_.src=be.none(_.src),_.setAttribute("loading","lazy"),_.setAttribute("decoding","async"),_.setAttribute("crossorigin","anonymous");return I.documentElement.outerHTML},C=()=>{p(k(o)),ve(o)},w=a=>{r.dispatch({changes:{from:s,insert:a},selection:{anchor:s+1,head:s+1}}),s+=a.length,r.focus(),C()},L={rangle:()=>w(">"),langle:()=>w("<"),rcurly:()=>w("}"),lcurly:()=>w("{"),copy:()=>{navigator.clipboard.writeText(o),N.add("Copied!")},clear:()=>{i(0,o=""),N.add("Cleared!")}},z=({target:a})=>{const y=a.id;if(!y)return 0;L[y]()};le(()=>{i(0,o=we()),f||(f=l.contentWindow.document),p(o),N.add("Compiler Loaded!"),window.editor=r});const M=a=>{if(!a.target.classList.contains("cm-line"))return 0;let[I,W]=[a.clientX,a.clientY];s=r.posAtCoords({x:I,y:W})};function d(){i(3,g=P.innerWidth)}function u(a){o=a,i(0,o)}function c(a){r=a,i(2,r)}function m(a){O[a?"unshift":"push"](()=>{l=a,i(1,l)})}return[o,l,r,g,t,C,z,M,d,u,c,m]}class Te extends ce{constructor(e){super(),ue(this,e,ke,ye,te,{})}}export{Te as component};
